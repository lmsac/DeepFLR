# Introduction
Codes for DeepFLR([paper]()).
# Requirements
Model construction was performed using python (3.8.3, Anaconda distribution version 5.3.1, https://www.anaconda.com/) with the following packages: FastNLP (0.6.0), pytorch (1.8.1) and transformers (4.12.5). 

Data analysis for FLR estimation was performed using python (3.8.3) with the following packages: pandas (1.0.5) and numpy (1.18.5). 
# Usage
## Model training
For model training, see ReadMe.md in `model` folder.

## Data analysis
### Sequence generation
Target and decoy phosphopeptide lists of singly phosphorylated peptides are generated by 

`python Targetdecoy_phosphopeptides_generation_mono.py --inputfile msms.txt --outputfile sequence.csv` 

where msms.txt is the result from Maxquant.

To deal with doubly phosphorylated peptides, target and decoy phosphopeptides are generated by  

`python Targetdecoy_phosphopeptides_generation_multi.py --inputfile msms.txt --outputfile sequence.csv`

### DeepFLR FLR estimation

To get DeepFLR FLR estimation,
`python DeepFLR FLR visualization.py --modelresultfile modelresult.csv --sequencefile sequence.csv  --outputfileFLRPSM  outputfileFLRPSM.csv`

Here, `modelresult.csv` is the result from `model/mgfprocess.py`, `sequence.csv` is the output from `Targetdecoy_phosphopeptides_generation_{mono,multi}.py`.

### DeepFLR result analysis
To obtain the identification results from DeepFLR for target FLR,

`python DeepFLR_result_processing.py --modelresultfile modelresult.csv --inputfile1 msms.txt --inputfile2 Phospho (STY)Sites.txt --sequencefile sequence.csv  --cutoff num --outputresult outputresult.csv`

Here, cutoff is the deltascore cutoff obtained from `FLR determination/DeepFLR FLR visualization.py` for target FLR. Phospho (STY)Sites.txt is the result from Maxquant.

### MaxQuant result analysis
To get the identification results from MaxQuant,

`python MaxQuant_result_processing.py --inputfile msms.txt --inputfile1 Phospho (STY)Sites.txt  --outputresult outputresult.csv`
