# Introduction
Codes for DeepFLR([paper]()).
# Requirements
Model construction was performed using python (3.8.3, Anaconda distribution version 5.3.1, https://www.anaconda.com/) with the following packages: FastNLP (0.6.0), pytorch (1.8.1) and transformers (4.12.5). 

Data analysis for FLR estimation was performed using python (3.8.3) with the following packages: pandas (1.0.5) and numpy (1.18.5). 
# Usage
## Model training
For model training, see ReadMe.md in `model` folder.

## Data analysis
### Sequence generation
Target and decoy phosphopeptide lists of singly phosphorylated peptides are generated by 

`python Targetdecoy_phosphopeptides_generation_mono.py --inputfile msms.txt --outputfile sequence.csv` 

where msms.txt is the result from Maxquant.

To deal with doubly phosphorylated peptides, target and decoy phosphopeptides are generated by  

`python Targetdecoy_phosphopeptides_generation_multi.py --inputfile msms.txt --outputfile sequence.csv`

### DeepFLR FLR estimation

To get DeepFLR FLR estimation,
`python DeepFLR_result_processing.py --modelresultfile modelresult.csv --sequencefile sequence.csv --outputresult outputresult.csv --outputfileFLRPSM  outputfileFLRPSM.csv`

Here, `modelresult.csv` is the result from `model/mgfprocess.py`, `sequence.csv` is the output from `Targetdecoy_phosphopeptides_generation_{mono,multi}.py`.

### Maxquant result analysis
To get Maxquant result analysis,

`python MaxQuant_result_processing.py --inputfile msms.txt --outputresult outputresult.csv`
